> STM32串口使用DMA方式接收数据可以减小CPU的开销。

下面讲述了如何实现dma加空闲中断 接收不定长数据 并 打印出来 如果有疑问可以来第一张桌子第一排最里面找我（潘德智）

> 硬件连接：usb转ttl 接 usart1 的引脚

> 效果：通过串口助手 输入不定长数据 单片机 输出此数据

将usb 转 ttl 换成我们的WiFi模块 就能实现 手机软件与单片机的通信 在此代码下 手机发什么 它就输出什么
把输出有关的函数换成 判断数据的函数（这里有个例子 ）就能实现手机通过WiFi模块发送指令 让单片机执行不同命令 换句话说 用学长发的软件控制小车
![image-20230826205125463](随想录 copy 2.assets/image-20230826205125463.png)

> Cubemx的配置

![image-20230826205141739](随想录 copy 2.assets/image-20230826205141739.png)

> TX 和RX 引脚 配置成 上拉 这是在库文件中看到的 但是我有一次忘了 发现也能正常工作

![image-20230826205212439](随想录 copy 2.assets/image-20230826205212439.png)

![image-20230826205223188](随想录 copy 2.assets/image-20230826205223188.png)

> RX采用circular 模式

![image-20230826205347716](随想录 copy 2.assets/image-20230826205347716.png)

> TX 采用normal 或者 circular 都可以

![image-20230826205414792](随想录 copy 2.assets/image-20230826205414792.png)

> 开启串口中断！！！！
> 优先级一定要改低一点 不然在串口中断中无法使用hal_delay

![image-20230826205426729](随想录 copy 2.assets/image-20230826205426729.png)

> 默认设置根据自己需求配置就好

![image-20230826205438590](随想录 copy 2.assets/image-20230826205438590.png)

> 代码

> 在main.c 中声名所需变量

![image-20230826205450909](随想录 copy 2.assets/image-20230826205450909.png)

> 在main函数中 使能中断 开启dma接收

![image-20230826205502409](随想录 copy 2.assets/image-20230826205502409.png)在`stm32f4xx_it.c`中写中断函数
![image-20230826211304432](随想录 copy 2.assets/image-20230826211304432.png)
